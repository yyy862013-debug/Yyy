<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>MC Panel ‚Äî Console</title>
  <style>
    :root{--bg:#0f172a;--accent:#10b981;--muted:rgba(255,255,255,0.35);--glass: rgba(15,23,42,0.55)}
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial;color:#e6eef8;background:linear-gradient(180deg,var(--bg),#071029)}
    .app{display:flex;min-height:100vh}
    .sidebar{width:84px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.05));backdrop-filter:blur(6px);display:flex;flex-direction:column;align-items:center;padding:18px 8px}
    .brand{font-weight:700;color:var(--accent);margin-bottom:8px}
    .side-nav{display:flex;flex-direction:column;gap:10px;margin-top:18px;width:100%;align-items:center}
    .nav-btn{width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:var(--muted);cursor:pointer;transition:all .18s}
    .nav-btn:hover{transform:translateY(-4px);color:#fff;box-shadow:0 6px 30px rgba(16,185,129,0.12)}
    .nav-btn.active{background:linear-gradient(180deg,rgba(16,185,129,0.12),rgba(16,185,129,0.06));color:var(--accent);box-shadow:0 8px 28px rgba(16,185,129,0.14)}
    .footer-actions{margin-top:auto;display:flex;flex-direction:column;gap:8px}
    .logout-small{font-size:12px;color:var(--muted);cursor:pointer}
    .main{flex:1;padding:28px}
    .card{background:var(--glass);backdrop-filter:blur(10px);border-radius:12px;padding:20px;border:1px solid rgba(255,255,255,0.04)}
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:18px}
    .terminal{background:linear-gradient(180deg,rgba(0,0,0,0.45),rgba(0,0,0,0.25));border-radius:10px;padding:12px;height:620px;overflow:auto;border:1px solid rgba(255,255,255,0.03);font-family:monospace;font-size:13px}
    .log-line{padding:6px 8px;border-radius:6px;margin-bottom:6px;white-space:pre-wrap}
    .log-install{color:#7dd3fc;background:rgba(125,211,252,0.03);border:1px solid rgba(125,211,252,0.04)}
    .log-info{color:#34d399;background:rgba(52,211,153,0.03);border:1px solid rgba(52,211,153,0.04)}
    .log-warn{color:#facc15;background:rgba(250,204,21,0.03);border:1px solid rgba(250,204,21,0.04)}
    .log-error{color:#fb7185;background:rgba(251,113,133,0.03);border:1px solid rgba(251,113,133,0.04)}
    .log-meta{color:#a8a8a8;background:rgba(168,168,168,0.03);border:1px solid rgba(168,168,168,0.04)}
    .cmd-input{display:flex;gap:8px;margin-top:12px}
    .cmd-input input{flex:1;padding:10px;border-radius:8px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.06);color:#e6eef8}
    .cmd-btn{padding:10px 16px;background:var(--accent);color:#021214;border:none;border-radius:8px;font-weight:800;cursor:pointer}
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">MC</div>
      <nav class="side-nav">
        <div class="nav-btn" data-page="dashboard" title="Dashboard" onclick="navigate('/dashboard.html')"><div style="font-size:20px">üìä</div></div>
        <div class="nav-btn active" data-page="console" title="Console" onclick="navigate('/console.html')"><div style="font-size:20px">üíª</div></div>
        <div class="nav-btn" data-page="files" title="File Manager" onclick="navigate('/files.html')"><div style="font-size:20px">üóÇÔ∏è</div></div>
        <div class="nav-btn" data-page="backups" title="Backups" onclick="navigate('/backups.html')"><div style="font-size:20px">üì¶</div></div>
        <div class="nav-btn" data-page="settings" title="Settings" onclick="navigate('/settings.html')"><div style="font-size:20px">‚öôÔ∏è</div></div>
      </nav>
      <div class="footer-actions">
        <div class="logout-small" onclick="location.href='/logout'">Logout</div>
      </div>
    </aside>

    <main class="main">
      <div class="card">
        <div class="topbar">
          <div>
            <div style="font-size:18px;font-weight:800">Console</div>
            <div style="font-size:12px;color:var(--muted)">Real-time server output</div>
          </div>
          <div style="text-align:right;font-size:12px;color:var(--muted)">User: <strong id="userDisplay">Admin</strong></div>
        </div>

        <div class="terminal" id="terminal">
          <div class="log-line log-info">[INFO] Console initialized.</div>
        </div>

        <div class="cmd-input">
          <input id="cmdInput" type="text" placeholder="Type command (e.g., help, say Hello)" autocomplete="off">
          <button class="cmd-btn" onclick="sendCommand()">Send</button>
        </div>
      </div>
    </main>
  </div>

  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
  <script>
    const socket = io();
    const term = document.getElementById('terminal');
    const cmdInput = document.getElementById('cmdInput');

    function navigate(page) {
      window.location.href = page;
    }

    function emitLog(type, text) {
      const div = document.createElement('div');
      const logClass = type === 'INSTALL' ? 'log-install' : type === 'INFO' ? 'log-info' : type === 'WARN' ? 'log-warn' : type === 'ERROR' ? 'log-error' : 'log-meta';
      div.className = 'log-line ' + logClass;
      div.textContent = `[${type}] ${text}`;
      term.appendChild(div);
      term.scrollTop = term.scrollHeight;
    }

    function sendCommand() {
      const cmd = cmdInput.value.trim();
      if (!cmd) return;
      emitLog('META', 'Sending: ' + cmd);
      socket.emit('send-command', cmd);
      cmdInput.value = '';
    }

    cmdInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') sendCommand();
    });

    // Listen for console output from backend
    socket.on('console-output', (msg) => {
      emitLog('INFO', msg);
    });

    // Parse and color-code incoming logs
    socket.on('install-progress', (pct) => {
      emitLog('INSTALL', `Progress: ${pct}%`);
    });

    document.getElementById('userDisplay').textContent = localStorage.getItem('username') || 'Admin';
  </script>
</body>
</html>
