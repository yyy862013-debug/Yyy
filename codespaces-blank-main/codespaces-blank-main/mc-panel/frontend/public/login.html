<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Apex Panel — Sign In</title>
  <style>
    :root{
      --navy:#0d1117;
      --emerald:#00e676;
      --emerald-dark:#00c853;
      --ruby:#ff4d4d;
      --muted:#8b949e;
      --text:#e6eef8;
      --glass:rgba(13,17,23,0.5);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Helvetica,Arial,sans-serif;color:var(--text);background:var(--navy);display:flex;align-items:center;justify-content:center}
    
    .login-container{width:100%;max-width:1000px;display:grid;grid-template-columns:1fr 420px;gap:40px;padding:40px}
    
    /* LEFT SIDE - ILLUSTRATION */
    .illustration-side{background:linear-gradient(135deg,rgba(0,230,118,0.08),rgba(0,0,0,0.3));border-radius:16px;padding:60px 40px;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;overflow:hidden;border:1px solid rgba(0,230,118,0.1)}
    
    .illustration-side::before{
      content:'';
      position:absolute;
      width:300px;
      height:300px;
      background:radial-gradient(circle,rgba(0,230,118,0.15),transparent);
      border-radius:50%;
      filter:blur(40px);
      top:-100px;right:-100px;
    }
    
    .illustration-content{position:relative;z-index:1;text-align:center}
    .illustration-icon{font-size:120px;margin-bottom:20px}
    .illustration-title{font-size:28px;font-weight:900;color:var(--emerald);margin-bottom:12px}
    .illustration-subtitle{font-size:14px;color:var(--muted);line-height:1.6}
    
    /* RIGHT SIDE - LOGIN FORM */
    .login-card{background:var(--glass);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.08);border-radius:16px;padding:40px;display:flex;flex-direction:column}
    
    .login-card h1{font-size:24px;font-weight:800;margin-bottom:8px}
    .login-card p{font-size:13px;color:var(--muted);margin-bottom:24px}
    
    .field{display:flex;flex-direction:column;gap:8px;margin-bottom:16px}
    .field label{font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:0.8px;font-weight:600}
    .field input{padding:12px 14px;border:1px solid rgba(255,255,255,0.12);background:rgba(255,255,255,0.04);border-radius:8px;color:var(--text);font-size:13px;transition:all .2s}
    .field input:focus{outline:none;border-color:var(--emerald);box-shadow:0 0 12px rgba(0,230,118,0.15)}
    .field input::placeholder{color:var(--muted)}
    
    .messages{margin-bottom:16px}
    .error-msg,.success-msg{padding:10px 12px;border-radius:8px;font-size:12px;display:none;margin-bottom:10px}
    .error-msg{background:rgba(255,77,77,0.1);border:1px solid rgba(255,77,77,0.3);color:#ff8a8a}
    .success-msg{background:rgba(0,230,118,0.1);border:1px solid rgba(0,230,118,0.3);color:var(--emerald)}
    
    .btn-login{padding:12px 16px;background:linear-gradient(135deg,var(--emerald),var(--emerald-dark));color:#000;border:none;border-radius:8px;font-weight:700;font-size:13px;cursor:pointer;transition:all .3s;display:flex;align-items:center;justify-content:center;gap:8px;box-shadow:0 4px 16px rgba(0,230,118,0.2);width:100%}
    .btn-login:hover{transform:translateY(-2px);box-shadow:0 8px 32px rgba(0,230,118,0.35)}
    .btn-login:active{transform:translateY(0)}
    .btn-login:disabled{opacity:0.5;cursor:not-allowed;transform:none}
    
    .spinner{display:none;width:14px;height:14px;border:2px solid rgba(0,0,0,0.2);border-top-color:#000;border-radius:50%;animation:spin .8s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    
    .login-note{font-size:11px;color:var(--muted);margin-top:16px;line-height:1.5;text-align:center}
    
    @media(max-width:900px){
      .login-container{grid-template-columns:1fr;gap:20px;padding:20px}
      .illustration-side{padding:40px 20px}
      .login-card{padding:30px}
    }
  </style>
</head>
<body>
  <div class="login-container">
    <!-- LEFT SIDE -->
    <div class="illustration-side">
      <div class="illustration-content">
        <div class="illustration-icon">⚡</div>
        <div class="illustration-title">Apex Panel</div>
        <div class="illustration-subtitle">
          Professional Minecraft<br>Server Hosting Platform<br><br>
          Manage your private servers<br>with enterprise-grade tools
        </div>
      </div>
    </div>

    <!-- RIGHT SIDE -->
    <form class="login-card" id="loginForm" onsubmit="handleLogin(event)">
      <h1>Sign In</h1>
      <p>Access your server dashboard</p>

      <div class="messages">
        <div class="error-msg" id="errorMsg"></div>
        <div class="success-msg" id="successMsg"></div>
      </div>

      <div class="field">
        <label for="username">Username</label>
        <input id="username" name="username" type="text" placeholder="admin" autocomplete="username" required>
      </div>

      <div class="field">
        <label for="password">Password</label>
        <input id="password" name="password" type="password" placeholder="••••••••" autocomplete="current-password" required>
      </div>

      <button class="btn-login" type="submit" id="loginBtn">
        <span class="spinner" id="spinner"></span>
        <span id="btnText">Sign In</span>
      </button>

      <div class="login-note">
        Default credentials: <strong>admin / password</strong><br>
        Change in backend settings for production use.
      </div>
    </form>
  </div>

  <script>
    async function handleLogin(event) {
      event.preventDefault();
      
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value;
      const btn = document.getElementById('loginBtn');
      const spinner = document.getElementById('spinner');
      const btnText = document.getElementById('btnText');
      const errorMsg = document.getElementById('errorMsg');
      const successMsg = document.getElementById('successMsg');
      
      // Reset messages
      errorMsg.style.display = 'none';
      successMsg.style.display = 'none';
      
      if (!username || !password) {
        errorMsg.textContent = 'Please fill in all fields';
        errorMsg.style.display = 'block';
        return;
      }
      
      // Show loading state
      btn.disabled = true;
      spinner.style.display = 'inline-block';
      btnText.textContent = 'Signing in...';
      
      try {
        const response = await fetch('/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded'
          },
          body: `username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`
        });
        
        if (response.ok || response.status === 302 || response.status === 301) {
          successMsg.textContent = '✓ Login successful! Redirecting...';
          successMsg.style.display = 'block';
          // Store username in localStorage for dashboard
          localStorage.setItem('panelUsername', username);
          // Redirect to dashboard
          setTimeout(() => {
            window.location.href = '/dashboard.html';
          }, 800);
        } else if (response.status === 401) {
          errorMsg.textContent = '✕ Invalid username or password';
          errorMsg.style.display = 'block';
          btn.disabled = false;
          spinner.style.display = 'none';
          btnText.textContent = 'Sign In';
          // Clear password field
          document.getElementById('password').value = '';
          document.getElementById('password').focus();
        } else {
          errorMsg.textContent = `✕ Login failed (${response.status})`;
          errorMsg.style.display = 'block';
          btn.disabled = false;
          spinner.style.display = 'none';
          btnText.textContent = 'Sign In';
        }
      } catch (error) {
        console.error('Login error:', error);
        errorMsg.textContent = '✕ Connection error. Please try again.';
        errorMsg.style.display = 'block';
        btn.disabled = false;
        spinner.style.display = 'none';
        btnText.textContent = 'Sign In';
      }
    }
  </script>
</body>
</html>
