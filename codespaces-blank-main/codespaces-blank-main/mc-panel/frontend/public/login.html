<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>MC Panel — Login</title>
  <style>
    :root{--bg:#0f172a;--accent:#10b981;--muted:rgba(255,255,255,0.45)}
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial;color:#e6eef8;background:linear-gradient(180deg,var(--bg),#071029);display:flex;align-items:center;justify-content:center}
    .login-shell{width:100%;max-width:980px;display:grid;grid-template-columns:1fr 420px;gap:24px;padding:28px}
    .illustration{background:linear-gradient(135deg,#07122a 0%,#112b3a 100%);border-radius:12px;padding:28px;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}
    .illustration .ore{width:80px;height:80px;border-radius:50%;filter:blur(12px);position:absolute}
    .ore.e{background:radial-gradient(circle,#10b981,#059669);top:40px;left:60px;box-shadow:0 0 40px #10b981}
    .ore.d{background:radial-gradient(circle,#60a5fa,#1d4ed8);bottom:50px;right:50px;box-shadow:0 0 40px #60a5fa}
    .illus-text{color:var(--accent);font-weight:800;font-size:22px}
    .login-card{background:rgba(15,23,42,0.6);backdrop-filter:blur(10px);border-radius:12px;padding:28px;border:1px solid rgba(255,255,255,0.04)}
    .login-card h2{font-size:20px;margin-bottom:6px}
    .login-card p{color:var(--muted);font-size:13px;margin-bottom:18px}
    .field{display:flex;flex-direction:column;gap:8px;margin-bottom:14px}
    .field label{font-size:12px;color:var(--muted);text-transform:uppercase}
    .field input{padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:rgba(255,255,255,0.02);color:#e6eef8;transition:all .2s}
    .field input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 12px rgba(16,185,129,0.2)}
    .btn{padding:12px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent),#34d399);color:#021214;font-weight:800;cursor:pointer;transition:all .3s;box-shadow:0 4px 16px rgba(16,185,129,0.15)}
    .btn:hover{transform:translateY(-2px);box-shadow:0 8px 32px rgba(16,185,129,0.35)}
    .btn:active{transform:translateY(0)}
    .btn:disabled{opacity:0.6;cursor:not-allowed}
    .spinner{display:none;width:16px;height:16px;border:2px solid rgba(255,255,255,0.2);border-top-color:var(--accent);border-radius:50%;animation:spin .8s linear infinite;margin-right:8px}
    @keyframes spin{to{transform:rotate(360deg)}}
    .btn-content{display:flex;align-items:center;justify-content:center}
    .error-msg{display:none;padding:10px;background:rgba(251,113,133,0.1);border:1px solid rgba(251,113,133,0.3);border-radius:8px;color:#fb7185;font-size:12px;margin-bottom:14px}
    .success-msg{display:none;padding:10px;background:rgba(52,211,153,0.1);border:1px solid rgba(52,211,153,0.3);border-radius:8px;color:#34d399;font-size:12px;margin-bottom:14px}
    .note{font-size:12px;color:var(--muted);margin-top:12px}
    @media(max-width:900px){.login-shell{grid-template-columns:1fr;gap:12px;padding:14px}}
  </style>
</head>
<body>
  <div class="login-shell">
    <div class="illustration">
      <div class="ore e"></div>
      <div class="ore d"></div>
      <div class="illus-text">Private Minecraft Server Panel</div>
    </div>

    <form class="login-card" id="loginForm" onsubmit="handleLogin(event)">
      <h2>Welcome back</h2>
      <p>Sign in to manage your servers</p>

      <div class="error-msg" id="errorMsg"></div>
      <div class="success-msg" id="successMsg"></div>

      <div class="field">
        <label for="username">Username</label>
        <input id="username" name="username" type="text" autocomplete="username" placeholder="admin" required>
      </div>

      <div class="field">
        <label for="password">Password</label>
        <input id="password" name="password" type="password" autocomplete="current-password" placeholder="••••••••" required>
      </div>

      <button class="btn" id="loginBtn" type="submit">
        <div class="btn-content">
          <div class="spinner" id="spinner"></div>
          <span id="btnText">Sign in</span>
        </div>
      </button>
      
      <div class="note">For private usage the default is <strong>admin / password</strong>. Change in backend for production.</div>
    </form>
  </div>

  <script>
    async function handleLogin(event) {
      event.preventDefault();
      
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value;
      const btn = document.getElementById('loginBtn');
      const spinner = document.getElementById('spinner');
      const btnText = document.getElementById('btnText');
      const errorMsg = document.getElementById('errorMsg');
      const successMsg = document.getElementById('successMsg');
      
      // Reset messages
      errorMsg.style.display = 'none';
      successMsg.style.display = 'none';
      
      if (!username || !password) {
        errorMsg.textContent = 'Please fill in all fields';
        errorMsg.style.display = 'block';
        return;
      }
      
      // Show loading state
      btn.disabled = true;
      spinner.style.display = 'inline-block';
      btnText.textContent = 'Logging in...';
      
      try {
        const response = await fetch('/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded'
          },
          body: `username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`
        });
        
        if (response.ok || response.status === 302 || response.status === 301) {
          successMsg.textContent = 'Login successful! Redirecting...';
          successMsg.style.display = 'block';
          // Store username in localStorage for dashboard
          localStorage.setItem('username', username);
          // Redirect to dashboard
          setTimeout(() => {
            window.location.href = '/dashboard.html';
          }, 500);
        } else if (response.status === 401) {
          errorMsg.textContent = 'Invalid username or password';
          errorMsg.style.display = 'block';
          btn.disabled = false;
          spinner.style.display = 'none';
          btnText.textContent = 'Sign in';
        } else {
          errorMsg.textContent = `Login failed (${response.status})`;
          errorMsg.style.display = 'block';
          btn.disabled = false;
          spinner.style.display = 'none';
          btnText.textContent = 'Sign in';
        }
      } catch (error) {
        console.error('Login error:', error);
        errorMsg.textContent = 'Connection error. Please try again.';
        errorMsg.style.display = 'block';
        btn.disabled = false;
        spinner.style.display = 'none';
        btnText.textContent = 'Sign in';
      }
    }
  </script>
</body>
</html>
