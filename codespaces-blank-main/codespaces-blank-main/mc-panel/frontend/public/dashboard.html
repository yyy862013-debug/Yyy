<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MC Panel ‚Äî Dashboard</title>
    <style>
        :root{
            --bg:#0f172a;
            --accent:#10b981;
            --muted:rgba(255,255,255,0.35);
            --glass: rgba(15,23,42,0.55);
        }
        *{box-sizing:border-box;margin:0;padding:0}
        html,body{height:100%;font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial;color:#e6eef8;background:linear-gradient(180deg,var(--bg),#071029)}
        .app{display:flex;min-height:100vh}
        .sidebar{width:84px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.05));backdrop-filter:blur(6px);display:flex;flex-direction:column;align-items:center;padding:18px 8px}
        .brand{font-weight:700;color:var(--accent);margin-bottom:8px}
        .side-nav{display:flex;flex-direction:column;gap:10px;margin-top:18px;width:100%;align-items:center}
        .nav-btn{width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:var(--muted);cursor:pointer;transition:all .18s}
        .nav-btn:hover{transform:translateY(-4px);color:#fff;box-shadow:0 6px 30px rgba(16,185,129,0.12)}
        .nav-btn.active{background:linear-gradient(180deg,rgba(16,185,129,0.12),rgba(16,185,129,0.06));color:var(--accent);box-shadow:0 8px 28px rgba(16,185,129,0.14)}
        .footer-actions{margin-top:auto;display:flex;flex-direction:column;gap:8px}
        .logout-small{font-size:12px;color:var(--muted);cursor:pointer}
        .main{flex:1;padding:28px}
        .card{background:var(--glass);backdrop-filter:blur(10px);border-radius:12px;padding:20px;border:1px solid rgba(255,255,255,0.04)}
        .topbar{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:18px}
        .status-badge{display:flex;align-items:center;gap:10px}
        .status-pill{padding:8px 14px;border-radius:999px;font-weight:700;font-size:13px;display:inline-flex;align-items:center;gap:8px;color:#04201a}
        .status-online{background:linear-gradient(90deg,#6ef0b6,#10b981);box-shadow:0 8px 40px rgba(16,185,129,0.18)}
        .status-offline{background:linear-gradient(90deg,#ffb3b3,#ff6b6b);box-shadow:0 8px 40px rgba(255,107,107,0.12)}
        .status-install{background:linear-gradient(90deg,#ffd87a,#ffb347);box-shadow:0 8px 40px rgba(255,180,75,0.12)}
        .metrics{display:flex;gap:12px;margin-top:8px}
        .metric{flex:1;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column;gap:6px}
        .metric .label{font-size:12px;color:var(--muted)}
        .metric .value{font-weight:700;color:#fff;font-size:18px}
        .grid{display:grid;grid-template-columns:2fr 1fr;gap:16px;margin-top:18px}
        .terminal{background:linear-gradient(180deg,rgba(0,0,0,0.45),rgba(0,0,0,0.25));border-radius:10px;padding:12px;height:520px;overflow:auto;border:1px solid rgba(255,255,255,0.03);font-family:monospace;font-size:13px}
        .log-line{padding:6px 8px;border-radius:6px;margin-bottom:6px;white-space:pre-wrap}
        .log-install{color:#7dd3fc;background:rgba(125,211,252,0.03);border:1px solid rgba(125,211,252,0.04)}
        .log-info{color:#34d399;background:rgba(52,211,153,0.03);border:1px solid rgba(52,211,153,0.04)}
        .log-warn{color:#facc15;background:rgba(250,204,21,0.03);border:1px solid rgba(250,204,21,0.04)}
        .log-error{color:#fb7185;background:rgba(251,113,133,0.03);border:1px solid rgba(251,113,133,0.04)}
        .quick-actions{display:flex;align-items:center;justify-content:space-between;gap:12px}
        .version-select{padding:10px;border-radius:10px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.04);color:#e6eef8}
        .install-btn{padding:10px 16px;background:linear-gradient(90deg,var(--accent),#34d399);color:#021214;border-radius:10px;border:none;font-weight:800;cursor:pointer;box-shadow:0 6px 30px rgba(16,185,129,0.12)}
        .progress-wrap{height:18px;background:rgba(255,255,255,0.03);border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.02)}
        .progress-bar{height:100%;width:0;background:linear-gradient(90deg,#10b981,#34d399);box-shadow:0 8px 40px rgba(16,185,129,0.18);transition:width .5s ease}
        @media(max-width:900px){.grid{grid-template-columns:1fr}.metrics{flex-direction:column}}
    </style>
</head>
<body>
    <div class="app">
        <aside class="sidebar">
            <div class="brand">MC</div>
            <nav class="side-nav">
                <div class="nav-btn active" data-page="dashboard" title="Dashboard"><div class="nav-icon">üìä</div></div>
                <div class="nav-btn" data-page="console" title="Console"><div class="nav-icon">üíª</div></div>
                <div class="nav-btn" data-page="files" title="File Manager"><div class="nav-icon">üóÇÔ∏è</div></div>
                <div class="nav-btn" data-page="backups" title="Backups"><div class="nav-icon">üì¶</div></div>
                <div class="nav-btn" data-page="settings" title="Settings"><div class="nav-icon">‚öôÔ∏è</div></div>
            </nav>
            <div class="footer-actions">
                <div class="logout-small" onclick="location.href='/logout'">Logout</div>
            </div>
        </aside>

        <main class="main">
            <div class="card">
                <div class="topbar">
                    <div>
                        <div style="font-size:18px;font-weight:800">Server Hub</div>
                        <div style="font-size:12px;color:var(--muted)">Manage your private instances</div>
                    </div>

                    <div class="status-badge">
                        <div id="status" class="status-pill status-offline">‚óè Offline</div>
                        <div style="text-align:right;font-size:12px;color:var(--muted)">User: <strong id="userDisplay">Admin</strong></div>
                    </div>
                </div>

                <div class="metrics">
                    <div class="metric">
                        <div class="label">CPU Usage</div>
                        <div class="value" id="cpuVal">0%</div>
                    </div>
                    <div class="metric">
                        <div class="label">RAM Usage</div>
                        <div class="value" id="ramVal">0.0GB / 4GB</div>
                    </div>
                    <div class="metric">
                        <div class="label">Players</div>
                        <div class="value" id="playersVal">0 / 20</div>
                    </div>
                </div>

                <div class="grid">
                    <section>
                        <div style="display:flex;flex-direction:column;gap:12px">
                            <div class="card" style="padding:12px">
                                <div class="quick-actions">
                                    <div class="quick-left">
                                        <select id="versionSelect" class="version-select">
                                            <option>Loading versions...</option>
                                        </select>
                                        <button id="installBtn" class="install-btn">Install / Update</button>
                                    </div>
                                    <div style="width:45%">
                                        <div class="progress-wrap"><div id="progressBar" class="progress-bar"></div></div>
                                    </div>
                                </div>
                            </div>

                            <div class="card terminal" id="terminal">
                                <!-- Log lines will be appended here -->
                                <div class="log-line log-info">[INFO] Console ready.</div>
                            </div>
                        </div>
                    </section>

                    <aside>
                        <div class="card" style="display:flex;flex-direction:column;gap:12px">
                            <div style="font-weight:700">Quick Controls</div>
                            <button id="startBtn" style="padding:10px;border-radius:8px;background:var(--accent);border:none;color:#021214;font-weight:800;cursor:pointer">Start Server</button>
                            <button id="stopBtn" style="padding:10px;border-radius:8px;background:#2b3440;border:none;color:#fff;cursor:pointer">Stop Server</button>
                            <div style="margin-top:8px;font-size:13px;color:var(--muted)">Server Actions</div>
                        </div>
                    </aside>
                </div>
            </div>
        </main>
    </div>

    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script>
        const socket = io();
        const statusEl = document.getElementById('status');
        const cpuEl = document.getElementById('cpuVal');
        const ramEl = document.getElementById('ramVal');
        const playersEl = document.getElementById('playersVal');
        const term = document.getElementById('terminal');
        const progressBar = document.getElementById('progressBar');

        function emitLog(type, text){
            const div = document.createElement('div');
            div.className = 'log-line ' + (type==='INSTALL'? 'log-install' : type==='INFO'? 'log-info' : type==='WARN'? 'log-warn' : 'log-error');
            div.textContent = `[${type}] ${text}`;
            term.appendChild(div);
            term.scrollTop = term.scrollHeight;
        }

        // Socket.io listeners
        socket.on('console-output', (data) => {
            emitLog('INFO', data);
        });

        socket.on('install-progress', (progress) => {
            progressBar.style.width = progress + '%';
            emitLog('INSTALL', `Downloaded ${progress}%`);
        });

        socket.on('install-complete', () => {
            progressBar.style.width = '100%';
            emitLog('INFO', 'Install complete.');
            statusEl.className = 'status-pill status-online';
            statusEl.textContent = '‚óè Online';
        });

        socket.on('server-status', (status) => {
            if (status.cpu) cpuEl.textContent = status.cpu + '%';
            if (status.ram) ramEl.textContent = status.ram + 'GB / 4GB';
            if (status.players) playersEl.textContent = status.players + ' / 20';
            if (status.running !== undefined) {
                if (status.running) {
                    statusEl.className = 'status-pill status-online';
                    statusEl.textContent = '‚óè Online';
                } else {
                    statusEl.className = 'status-pill status-offline';
                    statusEl.textContent = '‚óè Offline';
                }
            }
        });

        // Navigation
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const page = btn.dataset.page;
                document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                window.location.href = `/${page}.html`;
            });
        });

        async function loadVersions(){
            try{
                const r = await fetch('/api/paper-versions');
                const data = await r.json();
                const sel = document.getElementById('versionSelect');
                sel.innerHTML = '';
                (data.versions||[]).slice(-20).reverse().forEach(v=>{
                    const o = document.createElement('option'); o.value = 'paper-'+v; o.textContent = 'Paper '+v; sel.appendChild(o);
                });
            }catch(e){
                const sel = document.getElementById('versionSelect'); sel.innerHTML = '<option>Unable to load</option>';
            }
        }

        document.getElementById('installBtn').addEventListener('click', () => {
            const ver = document.getElementById('versionSelect').value;
            if (!ver || ver === 'Loading versions...') {
                emitLog('ERROR', 'Please select a version first');
                return;
            }
            emitLog('INSTALL', 'Starting install for '+ver);
            statusEl.className = 'status-pill status-install';
            statusEl.textContent = '‚óè Installing';
            progressBar.style.width='10%';
            socket.emit('install-version', ver);
        });

        document.getElementById('startBtn').addEventListener('click', () => {
            emitLog('INFO','Start requested');
            socket.emit('start-server');
        });

        document.getElementById('stopBtn').addEventListener('click', () => {
            emitLog('WARN','Stop requested');
            socket.emit('stop-server');
        });

        loadVersions();
        document.getElementById('userDisplay').textContent = localStorage.getItem('username')||'Admin';
    </script>
</body>
</html>
        <div class="sidebar-logo">
            <div class="sidebar-logo-icon">‚öôÔ∏è</div>
            <div class="sidebar-logo-text">MC Panel</div>
        </div>

        <div class="sidebar-nav">
            <div class="nav-item active" onclick="navigateTo('dashboard')">
                <span class="nav-icon">üìä</span>
                <span>Dashboard</span>
            </div>
            <div class="nav-item" onclick="navigateTo('settings')">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span>Global Settings</span>
            </div>
        </div>

        <div class="sidebar-footer">
            <button class="logout-btn" onclick="logout()">üö™ Log Out</button>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="main-content">
        <div class="header">
            <div class="header-title">
                <h1>Server Hub</h1>
                <p>Select a server to manage</p>
            </div>
            <div class="user-info">
                <div class="user-avatar">A</div>
                <div class="user-name" id="username">Admin</div>
            </div>
        </div>

        <!-- SERVERS SECTION -->
        <div class="servers-section">
            <div class="section-title">
                <span>üéÆ</span>
                <span>Your Servers</span>
            </div>
            <div class="servers-grid" id="serversList">
                <!-- SERVER CARDS WILL BE LOADED HERE -->
            </div>
        </div>
    </div>

    <script>
        // Check authentication
        if (!localStorage.getItem('isLoggedIn')) {
            window.location.href = '/login.html';
        }

        // Sample server data
        const servers = [
            {
                id: 1,
                name: 'Vanilla Survival',
                icon: 'üåç',
                status: 'online',
                players: '2/20',
                ram: 75,
                maxRam: 2,
                type: 'Vanilla'
            },
            {
                id: 2,
                name: 'Creative Test',
                icon: 'üèóÔ∏è',
                status: 'offline',
                players: '0/0',
                ram: 0,
                maxRam: 2,
                type: 'Creative'
            },
            {
                id: 3,
                name: 'Modded Adventure',
                icon: '‚ö°',
                status: 'online',
                players: '5/30',
                ram: 1.2,
                maxRam: 3,
                type: 'Modded'
            }
        ];

        // Render servers
        function renderServers() {
            const serversList = document.getElementById('serversList');
            
            if (servers.length === 0) {
                serversList.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="empty-icon">üì≠</div>
                        <div class="empty-text">No Servers Configured</div>
                        <div class="empty-subtext">Create your first server to get started</div>
                    </div>
                `;
                return;
            }

            serversList.innerHTML = servers.map(server => `
                <div class="server-card">
                    <div class="server-header">
                        <div>
                            <div class="server-name">${server.name}</div>
                            <div class="server-status-badge status-${server.status}">
                                ${server.status === 'online' ? '‚óè Online' : '‚óè Offline'}
                            </div>
                        </div>
                        <div class="server-icon">${server.icon}</div>
                    </div>

                    <div class="server-info">
                        <div class="info-item">
                            <span class="info-label">Type</span>
                            <span class="info-value">${server.type}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Players</span>
                            <span class="info-value">${server.players}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">RAM Usage</span>
                            <span class="info-value">${server.ram}GB / ${server.maxRam}GB</span>
                        </div>
                        <div class="ram-bar">
                            <div class="ram-fill" style="width: ${(server.ram / server.maxRam) * 100}%"></div>
                        </div>
                    </div>

                    <div class="server-actions">
                        <button class="btn btn-manage" onclick="manageServer(${server.id})">Manage ‚Üí</button>
                        <button class="btn btn-secondary" onclick="viewDetails(${server.id})">Info</button>
                    </div>
                </div>
            `).join('');
        }

        // Navigation
        function navigateTo(page) {
            console.log(`Navigating to ${page}`);
            // Implement navigation logic here
        }

        function manageServer(id) {
            const server = servers.find(s => s.id === id);
            console.log(`Managing server: ${server.name}`);
            window.location.href = `/server.html?id=${id}`;
        }

        function viewDetails(id) {
            const server = servers.find(s => s.id === id);
            console.log(`Viewing details for: ${server.name}`);
            // Show modal or navigate to detail page
        }

        function logout() {
            localStorage.removeItem('isLoggedIn');
            window.location.href = '/login.html';
        }

        // Initialize
        renderServers();

        // Update username display
        const username = localStorage.getItem('username') || 'Admin';
        document.getElementById('username').textContent = username;

        // Simulate real-time updates (optional)
        setInterval(() => {
            // In a real app, fetch server status from backend
            // For now, just update RAM randomly to show it works
            servers.forEach(server => {
                if (server.status === 'online') {
                    server.ram = (Math.random() * server.maxRam).toFixed(2);
                }
            });
            // renderServers(); // Uncomment to see live updates
        }, 5000);
    </script>

</body>
</html>
